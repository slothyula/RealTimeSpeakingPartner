    <!-- Delete User Modal -->
    <div id="deleteUserModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(44,62,80,0.4); z-index: 2000; justify-content: center; align-items: center;">
        <div style="background: white; border-radius: 15px; width: 95%; max-width: 400px; box-shadow: 0 10px 40px rgba(44,62,80,0.15); overflow: hidden;">
            <div style="padding: 24px 24px 10px 24px; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
                <h2 style="margin: 0; font-size: 1.3rem;">üóëÔ∏è Delete User</h2>
            </div>
            <div style="padding: 24px; text-align: center;">
                <div style="font-size: 1.1rem; margin-bottom: 10px; color: #2c3e50;">Are you sure you want to delete user <b id="deleteUserModalName"></b>?</div>
                <div id="deleteUserModalError" style="display:none; color: #e74c3c; font-size: 0.95rem; margin-bottom: 10px;"></div>
                <div style="display: flex; gap: 12px; justify-content: center; margin-top: 20px;">
                    <button onclick="closeDeleteUserModal()" style="background: #f5f6fa; color: #667eea; border: none; padding: 10px 24px; border-radius: 8px; font-weight: 600; font-size: 1rem; cursor: pointer;">Cancel</button>
                    <button onclick="confirmDeleteUser()" style="background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); color: white; border: none; padding: 10px 24px; border-radius: 8px; font-weight: 600; font-size: 1rem; cursor: pointer;">Delete</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Add User Modal -->
    <div id="addUserModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(44,62,80,0.4); z-index: 2000; justify-content: center; align-items: center;">
        <div style="background: white; border-radius: 15px; width: 95%; max-width: 450px; box-shadow: 0 10px 40px rgba(44,62,80,0.15); overflow: hidden;">
            <div style="padding: 24px 24px 10px 24px; background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%); color: white;">
                <h2 style="margin: 0; font-size: 1.3rem;">‚ûï Add New User</h2>
            </div>
            <div style="padding: 24px;">
                <form id="addUserForm" onsubmit="submitAddUser(event)">
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #2c3e50;">Full Name *</label>
                        <input type="text" id="addUserName" required style="width: 100%; padding: 10px 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;" placeholder="Enter full name">
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #2c3e50;">Email *</label>
                        <input type="email" id="addUserEmail" required style="width: 100%; padding: 10px 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;" placeholder="Enter email address">
                    </div>
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; font-weight: 600; color: #2c3e50;">Password *</label>
                        <input type="password" id="addUserPassword" required minlength="6" style="width: 100%; padding: 10px 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem;" placeholder="Enter password (min 6 chars)">
                    </div>
                    <div id="addUserError" style="display:none; color: #e74c3c; font-size: 0.95rem; margin-bottom: 10px; padding: 10px; background: #fee; border-radius: 6px;"></div>
                    <div id="addUserSuccess" style="display:none; color: #27ae60; font-size: 0.95rem; margin-bottom: 10px; padding: 10px; background: #e8f8f0; border-radius: 6px;"></div>
                    <div style="display: flex; gap: 12px; justify-content: flex-end; margin-top: 20px;">
                        <button type="button" onclick="closeAddUserModal()" style="background: #f5f6fa; color: #667eea; border: none; padding: 10px 24px; border-radius: 8px; font-weight: 600; font-size: 1rem; cursor: pointer;">Cancel</button>
                        <button type="submit" id="addUserSubmitBtn" style="background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%); color: white; border: none; padding: 10px 24px; border-radius: 8px; font-weight: 600; font-size: 1rem; cursor: pointer;">Create User</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Delete Topic Modal -->
    <div id="deleteTopicModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(44,62,80,0.4); z-index: 2000; justify-content: center; align-items: center;">
        <div style="background: white; border-radius: 15px; width: 95%; max-width: 400px; box-shadow: 0 10px 40px rgba(44,62,80,0.15); overflow: hidden;">
            <div style="padding: 24px 24px 10px 24px; background: linear-gradient(135deg, #f39c12 0%, #e67e22 100%); color: white;">
                <h2 style="margin: 0; font-size: 1.3rem;">üóëÔ∏è Delete Topic</h2>
            </div>
            <div style="padding: 24px; text-align: center;">
                <div style="font-size: 1.1rem; margin-bottom: 10px; color: #2c3e50;">Are you sure you want to delete topic <b id="deleteTopicModalName"></b>?</div>
                <div style="font-size: 0.9rem; color: #7f8c8d; margin-bottom: 15px;">‚ö†Ô∏è Note: This will remove the topic permanently. Related conversations will not be deleted, but their topic reference will be cleared.</div>
                <div id="deleteTopicModalError" style="display:none; color: #e74c3c; font-size: 0.95rem; margin-bottom: 10px;"></div>
                <div style="display: flex; gap: 12px; justify-content: center; margin-top: 20px;">
                    <button onclick="closeDeleteTopicModal()" style="background: #f5f6fa; color: #667eea; border: none; padding: 10px 24px; border-radius: 8px; font-weight: 600; font-size: 1rem; cursor: pointer;">Cancel</button>
                    <button onclick="confirmDeleteTopic()" style="background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); color: white; border: none; padding: 10px 24px; border-radius: 8px; font-weight: 600; font-size: 1rem; cursor: pointer;">Delete</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Delete Conversation Modal -->
    <div id="deleteConversationModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(44,62,80,0.4); z-index: 2000; justify-content: center; align-items: center;">
        <div style="background: white; border-radius: 15px; width: 95%; max-width: 450px; box-shadow: 0 10px 40px rgba(44,62,80,0.15); overflow: hidden;">
            <div style="padding: 24px 24px 10px 24px; background: linear-gradient(135deg, #3498db 0%, #2980b9 100%); color: white;">
                <h2 style="margin: 0; font-size: 1.3rem;">üóëÔ∏è Delete Conversation</h2>
            </div>
            <div style="padding: 24px; text-align: center;">
                <div style="font-size: 1.1rem; margin-bottom: 10px; color: #2c3e50;">Are you sure you want to delete this conversation?</div>
                <div style="font-size: 0.95rem; color: #555; margin-bottom: 15px; background: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <div><strong>User:</strong> <span id="deleteConversationModalUser"></span></div>
                    <div><strong>Topic:</strong> <span id="deleteConversationModalTopic"></span></div>
                    <div><strong>Conversation ID:</strong> <span id="deleteConversationModalId"></span></div>
                </div>
                <div style="font-size: 0.9rem; color: #e74c3c; margin-bottom: 15px; padding: 10px; background: #fff3cd; border-radius: 6px;">
                    ‚ö†Ô∏è Warning: This will permanently delete the conversation and all associated messages, grammar mistakes, and feedback. This action cannot be undone.
                </div>
                <div id="deleteConversationModalError" style="display:none; color: #e74c3c; font-size: 0.95rem; margin-bottom: 10px;"></div>
                <div style="display: flex; gap: 12px; justify-content: center; margin-top: 20px;">
                    <button onclick="closeDeleteConversationModal()" style="background: #f5f6fa; color: #667eea; border: none; padding: 10px 24px; border-radius: 8px; font-weight: 600; font-size: 1rem; cursor: pointer;">Cancel</button>
                    <button onclick="confirmDeleteConversation()" style="background: linear-gradient(135deg, #e74c3c 0%, #c0392b 100%); color: white; border: none; padding: 10px 24px; border-radius: 8px; font-weight: 600; font-size: 1rem; cursor: pointer;">Delete</button>
                </div>
            </div>
        </div>
    </div>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Speaking Partner</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: #f5f6fa;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            position: fixed;
            left: 0;
            top: 0;
            width: 250px;
            height: 100vh;
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            padding: 20px;
            color: white;
        }

        .sidebar-logo {
            font-size: 1.5rem;
            font-weight: bold;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }

        .sidebar-menu {
            list-style: none;
        }

        .sidebar-menu li {
            margin-bottom: 5px;
        }

        .sidebar-menu a {
            display: flex;
            align-items: center;
            gap: 10px;
            color: rgba(255,255,255,0.7);
            text-decoration: none;
            padding: 12px 15px;
            border-radius: 8px;
            transition: all 0.3s;
        }

        .sidebar-menu a:hover,
        .sidebar-menu a.active {
            background: rgba(255,255,255,0.1);
            color: white;
        }

        /* Main Content */
        .main-content {
            margin-left: 250px;
            padding: 20px;
        }

        /* Header */
        .header {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .header h1 {
            font-size: 1.5rem;
            color: #2c3e50;
        }

        /* Stats Cards */
        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 20px;
        }

        .stat-card {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }

        .stat-card .stat-icon {
            font-size: 2rem;
            margin-bottom: 10px;
        }

        .stat-card .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: #2c3e50;
        }

        .stat-card .stat-label {
            color: #7f8c8d;
            font-size: 0.9rem;
        }

        /* Tables */
        .card {
            background: white;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            margin-bottom: 20px;
        }

        .card-header {
            padding: 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .card-header h2 {
            font-size: 1.2rem;
            color: #2c3e50;
        }

        .card-body {
            padding: 20px;
        }

        table {
            width: 100%;
            border-collapse: collapse;
        }

        th, td {
            text-align: left;
            padding: 12px 15px;
            border-bottom: 1px solid #eee;
        }

        th {
            background: #f8f9fa;
            font-weight: 600;
            color: #2c3e50;
        }

        tr:hover {
            background: #f8f9fa;
        }

        /* Badges */
        .badge {
            display: inline-block;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .badge-success { background: #d4edda; color: #155724; }
        .badge-warning { background: #fff3cd; color: #856404; }
        .badge-danger { background: #f8d7da; color: #721c24; }
        .badge-info { background: #cce5ff; color: #004085; }

        .badge-beginner { background: #d4edda; color: #155724; }
        .badge-intermediate { background: #fff3cd; color: #856404; }
        .badge-advanced { background: #f8d7da; color: #721c24; }

        /* Status badges for online/offline */
        .status-badge {
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: 600;
            display: inline-flex;
            align-items: center;
            gap: 4px;
        }

        .status-online {
            background: linear-gradient(135deg, #d4edda 0%, #c3e6cb 100%);
            color: #155724;
            box-shadow: 0 2px 8px rgba(40, 167, 69, 0.2);
        }

        .status-offline {
            background: linear-gradient(135deg, #e9ecef 0%, #dee2e6 100%);
            color: #6c757d;
        }

        /* Buttons */
        .btn {
            padding: 8px 16px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: all 0.3s;
        }

        .btn-primary {
            background: #3498db;
            color: white;
        }

        .btn-primary:hover {
            background: #2980b9;
        }

        .btn-sm {
            padding: 5px 10px;
            font-size: 0.8rem;
        }

        /* Search & Filters */
        .filters {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .filters input,
        .filters select {
            padding: 8px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 0.9rem;
        }

        .filters input:focus,
        .filters select:focus {
            outline: none;
            border-color: #3498db;
        }

        /* View Sections */
        .view-section {
            display: none;
        }

        .view-section.active {
            display: block;
        }

        /* Modal */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background: white;
            padding: 30px;
            border-radius: 10px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-close {
            background: none;
            border: none;
            font-size: 1.5rem;
            cursor: pointer;
            color: #7f8c8d;
        }

        /* Messages */
        .message-list {
            max-height: 400px;
            overflow-y: auto;
        }

        .message-item {
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 8px;
        }

        .message-item.user {
            background: #e8f4fd;
            margin-left: 20px;
        }

        .message-item.assistant {
            background: #f0f0f0;
            margin-right: 20px;
        }

        .message-sender {
            font-weight: 600;
            font-size: 0.85rem;
            margin-bottom: 5px;
            color: #2c3e50;
        }

        .message-time {
            font-size: 0.75rem;
            color: #7f8c8d;
            margin-top: 5px;
        }

        /* Chart placeholder */
        .chart-container {
            height: 300px;
            background: #f8f9fa;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #7f8c8d;
        }

        /* Loading */
        .loading {
            text-align: center;
            padding: 40px;
            color: #7f8c8d;
        }

        /* Login Page */
        .login-container {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .login-box {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            width: 100%;
            max-width: 400px;
        }

        .login-box h1 {
            text-align: center;
            color: #2c3e50;
            margin-bottom: 30px;
            font-size: 1.8rem;
        }

        .login-form-group {
            margin-bottom: 20px;
        }

        .login-form-group label {
            display: block;
            margin-bottom: 8px;
            color: #2c3e50;
            font-weight: 600;
        }

        .login-form-group input {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        .login-form-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .login-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .login-btn:hover {
            transform: translateY(-2px);
        }

        .login-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }

        .login-error {
            background: #fee;
            color: #c33;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }

        .admin-panel {
            display: none;
        }

        .admin-panel.active {
            display: block;
        }
    </style>
</head>
<body>
    <!-- Login Page -->
    <div id="loginPage" class="login-container">
        <div class="login-box">
            <h1>üéì Admin Login</h1>
            <div id="loginError" class="login-error"></div>
            <form id="loginForm" onsubmit="handleAdminLogin(event); return false;">
                <div class="login-form-group">
                    <label for="adminUsername">Username</label>
                    <input type="text" id="adminUsername" name="username" required autocomplete="username">
                </div>
                <div class="login-form-group">
                    <label for="adminPassword">Password</label>
                    <input type="password" id="adminPassword" name="password" required autocomplete="current-password">
                </div>
                <button type="submit" class="login-btn" id="loginBtn">Login</button>
            </form>
        </div>
    </div>

    <!-- Admin Panel (hidden until login) -->
    <div id="adminPanel" class="admin-panel">
        <!-- Sidebar -->
        <div class="sidebar">
            <div class="sidebar-logo">
                üéì Admin Panel
            </div>
            <ul class="sidebar-menu">
                <li><a href="#" onclick="showView('dashboard')" class="active" id="nav-dashboard">üìä Dashboard</a></li>
                <li><a href="#" onclick="showView('users')" id="nav-users">üë• Users</a></li>
                <li><a href="#" onclick="showView('userlevels')" id="nav-userlevels">üåç User Levels</a></li>
                <li><a href="#" onclick="showView('conversations')" id="nav-conversations">üí¨ Conversations</a></li>
                <li><a href="#" onclick="showView('topics')" id="nav-topics">üìö Topics</a></li>
                <li><a href="#" onclick="handleAdminLogout()" style="color: #e74c3c;">üö™ Logout</a></li>
            </ul>
        </div>

        <!-- Main Content -->
        <div class="main-content">
        <!-- Dashboard View -->
        <div class="view-section active" id="view-dashboard">
            <div class="header">
                <h1>üìä Dashboard</h1>
                <span id="lastUpdate">Last updated: -</span>
            </div>

            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-icon">üë•</div>
                    <div class="stat-value" id="stat-users">-</div>
                    <div class="stat-label">Total Users</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üÜï</div>
                    <div class="stat-value" id="stat-newUsers">-</div>
                    <div class="stat-label">New Today</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üí¨</div>
                    <div class="stat-value" id="stat-conversations">-</div>
                    <div class="stat-label">Conversations Today</div>
                </div>
                <div class="stat-card">
                    <div class="stat-icon">üìù</div>
                    <div class="stat-value" id="stat-messages">-</div>
                    <div class="stat-label">Messages Today</div>
                </div>
                <div class="stat-card clickable" onclick="showActiveSessions()" style="cursor: pointer; transition: transform 0.2s;">
                    <div class="stat-icon">üü¢</div>
                    <div class="stat-value" id="stat-active">-</div>
                    <div class="stat-label">Active Sessions</div>
                    <div style="font-size: 0.7rem; color: #667eea; margin-top: 5px;">Click to view details</div>
                </div>
            </div>
        </div>

        <!-- Users View -->
        <div class="view-section" id="view-users">
            <div class="header">
                <h1>üë• Users</h1>
                <button onclick="showAddUserModal()" style="background: linear-gradient(135deg, #27ae60 0%, #2ecc71 100%); color: white; border: none; padding: 10px 20px; border-radius: 8px; font-weight: 600; cursor: pointer; display: flex; align-items: center; gap: 8px;">
                    ‚ûï Add User
                </button>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2>All Users</h2>
                </div>
                <div class="card-body">
                    <div class="filters">
                        <input type="text" placeholder="Search by name or email..." id="userSearch" onkeyup="filterUsers()">
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Conversations</th>
                                <th>Practice Time</th>
                                <th>Registered</th>
                                <th>State</th>
                                <th>Delete</th>
                            </tr>
                        </thead>
                        <tbody id="usersTable">
                            <tr><td colspan="8" class="loading">Loading...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- User Levels View -->
        <div class="view-section" id="view-userlevels">
            <div class="header">
                <h1>üåç User Levels</h1>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2>Language Proficiency by User</h2>
                </div>
                <div class="card-body">
                    <div class="filters">
                        <input type="text" placeholder="Search by user name..." id="userLevelsSearch" onkeyup="filterUserLevels()">
                        <select id="languageFilter" onchange="filterUserLevels()">
                            <option value="">All Languages</option>
                            <option value="en">üá¨üáß English</option>
                            <option value="es">üá™üá∏ Spanish (Espa√±ol)</option>
                            <option value="fr">üá´üá∑ French (Fran√ßais)</option>
                            <option value="de">üá©üá™ German (Deutsch)</option>
                            <option value="it">üáÆüáπ Italian (Italiano)</option>
                            <option value="pt">üáµüáπ Portuguese (Portugu√™s)</option>
                            <option value="ru">üá∑üá∫ Russian (–†—É—Å—Å–∫–∏–π)</option>
                            <option value="zh">üá®üá≥ Chinese (‰∏≠Êñá)</option>
                            <option value="ja">üáØüáµ Japanese (Êó•Êú¨Ë™û)</option>
                            <option value="ko">üá∞üá∑ Korean (ÌïúÍµ≠Ïñ¥)</option>
                            <option value="tr">üáπüá∑ Turkish (T√ºrk√ße)</option>
                            <option value="ar">üá∏üá¶ Arabic (ÿßŸÑÿπÿ±ÿ®Ÿäÿ©)</option>
                        </select>
                    </div>
                    <div id="userLevelsContainer" style="margin-top: 20px;">
                        <div class="loading">Loading user levels...</div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Conversations View -->
        <div class="view-section" id="view-conversations">
            <div class="header">
                <h1>üí¨ Conversations</h1>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2>All Conversations</h2>
                </div>
                <div class="card-body">
                    <div class="filters">
                        <select id="convStatusFilter" onchange="filterConversations()">
                            <option value="">All Status</option>
                            <option value="active">Active</option>
                            <option value="completed">Completed</option>
                            <option value="abandoned">Abandoned</option>
                        </select>
                        <input type="date" id="convStartDate" onchange="filterConversations()">
                        <input type="date" id="convEndDate" onchange="filterConversations()">
                    </div>
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>User</th>
                                <th>Topic</th>
                                <th>Language</th>
                                <th>Messages</th>
                                <th>Duration</th>
                                <th>Score</th>
                                <th>Date</th>
                                <th>Delete</th>
                            </tr>
                        </thead>
                        <tbody id="conversationsTable">
                            <tr><td colspan="9" class="loading">Loading...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- Topics View -->
        <div class="view-section" id="view-topics">
            <div class="header">
                <h1>üìö Topics</h1>
                <button class="btn btn-primary" onclick="showAddTopicModal()">‚ûï Add Topic</button>
            </div>

            <div class="card">
                <div class="card-header">
                    <h2>All Topics</h2>
                </div>
                <div class="card-body">
                    <table>
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Category</th>
                                <th>Difficulty</th>
                                <th>Language</th>
                                <th>Usage</th>
                                <th>Delete</th>
                            </tr>
                        </thead>
                        <tbody id="topicsTable">
                            <tr><td colspan="7" class="loading">Loading...</td></tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

    </div>

    <!-- Conversation Messages Modal -->
    <div class="modal" id="messagesModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üí¨ Conversation Messages</h2>
                <button class="modal-close" onclick="closeModal('messagesModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="message-list" id="messagesList">
                    <!-- Messages will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- User Detail Modal -->
    <div class="modal" id="userModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üë§ User Details</h2>
                <button class="modal-close" onclick="closeModal('userModal')">&times;</button>
            </div>
            <div class="modal-body" id="userDetails">
                <!-- User details will be loaded here -->
            </div>
        </div>
    </div>

    <!-- Add Topic Modal -->
    <div class="modal" id="addTopicModal">
        <div class="modal-content" style="max-width: 600px;">
            <div class="modal-header">
                <h2>üìö Add New Topic</h2>
                <button class="modal-close" onclick="closeModal('addTopicModal')">&times;</button>
            </div>
            <div class="modal-body">
                <form id="addTopicForm" onsubmit="submitAddTopic(event)">
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; font-weight: 600;">Topic Name *</label>
                        <input type="text" id="topicName" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;" placeholder="e.g., Job Interview Practice">
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; font-weight: 600;">Description</label>
                        <small style="display: block; margin-bottom: 5px; color: #666;">üí° Keep it short - just describe what this topic is about (e.g., "Discuss technology in daily life, apps, and devices.")</small>
                        <textarea id="topicDescription" rows="2" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; resize: vertical;" placeholder="e.g., Practice discussing health habits, exercise routines, and fitness goals."></textarea>
                    </div>
                    
                    <div style="display: flex; gap: 15px; margin-bottom: 15px;">
                        <div style="flex: 1;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600;">Category *</label>
                            <select id="topicCategory" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                                <option value="">Select Category</option>
                                <option value="daily">Daily Life</option>
                                <option value="business">Business</option>
                                <option value="academic">Academic</option>
                                <option value="travel">Travel</option>
                                <option value="technology">Technology</option>
                                <option value="entertainment">Entertainment</option>
                                <option value="health">Health</option>
                                <option value="sports">Sports</option>
                                <option value="culture">Culture</option>
                                <option value="other">Other</option>
                            </select>
                        </div>
                        <div style="flex: 1;">
                            <label style="display: block; margin-bottom: 5px; font-weight: 600;">Difficulty *</label>
                            <select id="topicDifficulty" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                                <option value="">Select Difficulty</option>
                                <option value="beginner">Beginner</option>
                                <option value="intermediate">Intermediate</option>
                                <option value="advanced">Advanced</option>
                            </select>
                        </div>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; font-weight: 600;">Target Language *</label>
                        <small style="display: block; margin-bottom: 5px; color: #666;">üåê Select the language this topic is for practicing</small>
                        <select id="topicTargetLanguage" required style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px;">
                            <option value="English">English</option>
                            <option value="Spanish">Spanish (Espa√±ol)</option>
                            <option value="French">French (Fran√ßais)</option>
                            <option value="German">German (Deutsch)</option>
                            <option value="Italian">Italian (Italiano)</option>
                            <option value="Portuguese">Portuguese (Portugu√™s)</option>
                            <option value="Russian">Russian (–†—É—Å—Å–∫–∏–π)</option>
                            <option value="Chinese">Chinese (‰∏≠Êñá)</option>
                            <option value="Japanese">Japanese (Êó•Êú¨Ë™û)</option>
                            <option value="Korean">Korean (ÌïúÍµ≠Ïñ¥)</option>
                            <option value="Turkish">Turkish (T√ºrk√ße)</option>
                            <option value="Arabic">Arabic (ÿßŸÑÿπÿ±ÿ®Ÿäÿ©)</option>
                        </select>
                    </div>
                    
                    <div style="margin-bottom: 15px;">
                        <label style="display: block; margin-bottom: 5px; font-weight: 600;">Sample Questions (one per line)</label>
                        <textarea id="topicQuestions" rows="4" style="width: 100%; padding: 10px; border: 1px solid #ddd; border-radius: 6px; font-size: 14px; resize: vertical;" placeholder="What do you think about...?&#10;Can you describe...?&#10;How would you handle...?"></textarea>
                    </div>
                    
                    <div style="display: flex; gap: 10px; justify-content: flex-end; margin-top: 20px;">
                        <button type="button" class="btn" style="background: #95a5a6; color: white;" onclick="closeModal('addTopicModal')">Cancel</button>
                        <button type="submit" class="btn btn-primary" id="addTopicBtn">‚ûï Add Topic</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        // Admin authentication state
        let adminToken = localStorage.getItem('adminToken');
        let currentAdmin = null;

        // State
        let allUsers = [];
        let allConversations = [];

        // Login handler function - Define early as global function
        async function handleAdminLogin(event) {
            event.preventDefault();
            console.log('üîê Login button clicked!');
            
            const usernameInput = document.getElementById('adminUsername');
            const passwordInput = document.getElementById('adminPassword');
            const loginBtn = document.getElementById('loginBtn');
            const errorDiv = document.getElementById('loginError');

            if (!usernameInput || !passwordInput || !loginBtn || !errorDiv) {
                console.error('‚ùå Form elements not found!');
                return;
            }

            const username = usernameInput.value.trim();
            const password = passwordInput.value;

            console.log('üìù Form values:', { username, hasPassword: !!password });

            if (!username || !password) {
                errorDiv.textContent = 'Please enter both username and password';
                errorDiv.style.display = 'block';
                return;
            }

            loginBtn.disabled = true;
            loginBtn.textContent = 'Logging in...';
            errorDiv.style.display = 'none';

            try {
                console.log('üîê Sending login request...', { username });
                const response = await fetch('/api/admin/login', {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ username, password })
                });

                console.log('üì° Response status:', response.status);
                const result = await response.json();
                console.log('üì¶ Response data:', result);

                if (result.success && result.token) {
                    adminToken = result.token;
                    currentAdmin = result.admin;
                    localStorage.setItem('adminToken', adminToken);
                    showAdminPanel();
                } else {
                    errorDiv.textContent = result.message || 'Invalid username or password';
                    errorDiv.style.display = 'block';
                }
            } catch (error) {
                console.error('Login error:', error);
                errorDiv.textContent = 'Failed to connect to server. Please try again.';
                errorDiv.style.display = 'block';
            } finally {
                if (loginBtn) {
                    loginBtn.disabled = false;
                    loginBtn.textContent = 'Login';
                }
            }
        }

        // Make function globally accessible for inline onsubmit
        window.handleAdminLogin = handleAdminLogin;

        // Check if admin is logged in on page load
        document.addEventListener('DOMContentLoaded', async () => {
            // Setup login form event listener (function is already defined globally)
            const loginForm = document.getElementById('loginForm');
            if (loginForm) {
                loginForm.addEventListener('submit', handleAdminLogin);
                console.log('‚úÖ Login form event listener attached');
            } else {
                console.error('‚ùå Login form not found!');
            }

            if (adminToken) {
                // Verify token is still valid
                try {
                    const response = await fetch('/api/admin/me', {
                        headers: {
                            'Authorization': `Bearer ${adminToken}`
                        }
                    });
                    if (response.ok) {
                        const result = await response.json();
                        if (result.success) {
                            currentAdmin = result.admin;
                            showAdminPanel();
                            return;
                        }
                    }
                } catch (error) {
                    console.error('Token verification failed:', error);
                }
                // Token invalid, clear it
                adminToken = null;
                localStorage.removeItem('adminToken');
            }
            showLoginPage();
        });

        function showLoginPage() {
            document.getElementById('loginPage').style.display = 'flex';
            document.getElementById('adminPanel').classList.remove('active');
        }

        function showAdminPanel() {
            document.getElementById('loginPage').style.display = 'none';
            document.getElementById('adminPanel').classList.add('active');
            // Load dashboard
            loadDashboard();
        }


        async function handleAdminLogout() {
            if (confirm('Are you sure you want to logout?')) {
                if (adminToken) {
                    try {
                        await fetch('/api/admin/logout', {
                            method: 'POST',
                            headers: {
                                'Authorization': `Bearer ${adminToken}`
                            }
                        });
                    } catch (error) {
                        console.error('Logout error:', error);
                    }
                }
                adminToken = null;
                currentAdmin = null;
                localStorage.removeItem('adminToken');
                showLoginPage();
            }
        }

        // API Helper with admin authentication
        async function api(endpoint, method = 'GET', body = null) {
            const options = {
                method: method,
                headers: {
                    'Content-Type': 'application/json'
                }
            };

            // Add admin token to headers
            if (adminToken) {
                options.headers = {
                    ...options.headers,
                    'Authorization': `Bearer ${adminToken}`
                };
            }

            if (body) {
                options.body = JSON.stringify(body);
            }

            const response = await fetch(`/api/admin${endpoint}`, options);
            
            // If unauthorized, redirect to login
            if (response.status === 401) {
                adminToken = null;
                localStorage.removeItem('adminToken');
                showLoginPage();
                throw new Error('Unauthorized');
            }

            return response.json();
        }

        // View Navigation
        function showView(viewName) {
            document.querySelectorAll('.view-section').forEach(v => v.classList.remove('active'));
            document.querySelectorAll('.sidebar-menu a').forEach(a => a.classList.remove('active'));
            
            document.getElementById(`view-${viewName}`).classList.add('active');
            document.getElementById(`nav-${viewName}`).classList.add('active');

            // Load data for the view
            switch(viewName) {
                case 'dashboard': loadDashboard(); break;
                case 'users': loadUsers(); break;
                case 'userlevels': loadUserLevels(); break;
                case 'conversations': loadConversations(); break;
                case 'topics': loadTopics(); break;
                case 'analytics': loadAnalytics(); break;
            }
        }

        // Dashboard
        async function loadDashboard() {
            try {
                const result = await api('/dashboard');
                if (result.success) {
                    const { stats, dailyStats, activeUsers, popularTopics } = result.data;
                    
                    // Update stats
                    document.getElementById('stat-users').textContent = stats.total_users || 0;
                    document.getElementById('stat-newUsers').textContent = stats.new_users_today || 0;
                    document.getElementById('stat-conversations').textContent = stats.conversations_today || 0;
                    document.getElementById('stat-messages').textContent = stats.messages_today || 0;
                    document.getElementById('stat-active').textContent = stats.active_sessions || 0;
                }
                document.getElementById('lastUpdate').textContent = 'Last updated: ' + new Date().toLocaleTimeString();
            } catch (error) {
                console.error('Error loading dashboard:', error);
                document.getElementById('lastUpdate').textContent = 'Last updated: ' + new Date().toLocaleTimeString() + ' (error)';
            }
        }

        // Users
        async function loadUsers() {
            await loadOnlineUserIds(); // Load online users first
            try {
                const result = await api('/users');
                if (result.success && result.data && result.data.users) {
                    allUsers = result.data.users;
                    renderUsers(allUsers);
                } else {
                    document.getElementById('usersTable').innerHTML = '<tr><td colspan="8" style="text-align:center;padding:40px;color:#7f8c8d;">No users found</td></tr>';
                }
            } catch (error) {
                console.error('Error loading users:', error);
                document.getElementById('usersTable').innerHTML = '<tr><td colspan="8" style="text-align:center;padding:40px;color:#7f8c8d;">Failed to load users</td></tr>';
            }
        }

        let onlineUserIds = [];

        async function loadOnlineUserIds() {
            try {
                const response = await fetch('/api/admin/online-user-ids');
                const result = await response.json();
                if (result.success) {
                    onlineUserIds = result.onlineUserIds || [];
                    console.log('Online user IDs loaded:', onlineUserIds);
                }
            } catch (error) {
                console.error('Error loading online users:', error);
                onlineUserIds = [];
            }
        }

        function renderUsers(users) {
            document.getElementById('usersTable').innerHTML = users.map(u => {
                const isOnline = onlineUserIds.includes(u.user_id);
                const statusBadge = isOnline 
                    ? '<span class="status-badge status-online">üü¢ Online</span>'
                    : '<span class="status-badge status-offline">‚ö™ Offline</span>';
                // Trash icon button
                const deleteBtn = `<button title="Delete User" class="delete-user-btn" onclick="deleteUser(${u.user_id}, '${u.name.replace(/'/g, '\'')}', this)"><svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 18L18 6M6 6l12 12'/></svg></button>`;
                return `
                <tr>
                    <td>${u.user_id}</td>
                    <td>${u.name}</td>
                    <td>${u.email}</td>
                    <td>${u.total_conversations}</td>
                    <td>${u.total_practice_minutes} min</td>
                    <td>${new Date(u.created_at).toLocaleDateString()}</td>
                    <td>${statusBadge}</td>
                    <td>${deleteBtn}</td>
                </tr>
            `}).join('') || '<tr><td colspan="8">No users found</td></tr>';
        }

        // Custom Delete User Modal
        let deleteUserModal = null;
        let deleteUserModalBtn = null;
        let deleteUserModalUserId = null;
        function showDeleteUserModal(userId, userName, btn) {
            deleteUserModalUserId = userId;
            deleteUserModalBtn = btn;
            document.getElementById('deleteUserModalName').textContent = userName;
            deleteUserModal.classList.add('active');
        }

        async function confirmDeleteUser() {
            const userId = deleteUserModalUserId;
            const btn = deleteUserModalBtn;
            btn.disabled = true;
            btn.innerHTML = '<span style="color:#e74c3c;">Deleting...</span>';
            try {
                const result = await api(`/users/${userId}`, 'DELETE');
                if (result.success) {
                    allUsers = allUsers.filter(u => u.user_id !== userId);
                    renderUsers(allUsers);
                    closeDeleteUserModal();
                } else {
                    showDeleteUserError(result.message || 'Failed to delete user.');
                    btn.disabled = false;
                    btn.innerHTML = `<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 18L18 6M6 6l12 12'/></svg>`;
                }
            } catch (error) {
                showDeleteUserError('Failed to delete user.');
                btn.disabled = false;
                btn.innerHTML = `<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 18L18 6M6 6l12 12'/></svg>`;
            }
        }

        function closeDeleteUserModal() {
            deleteUserModal.classList.remove('active');
            document.getElementById('deleteUserModalError').style.display = 'none';
        }

        function showDeleteUserError(msg) {
            const err = document.getElementById('deleteUserModalError');
            err.textContent = msg;
            err.style.display = 'block';
        }

        // ========== ADD USER MODAL FUNCTIONS ==========
        function showAddUserModal() {
            document.getElementById('addUserModal').style.display = 'flex';
            document.getElementById('addUserForm').reset();
            document.getElementById('addUserError').style.display = 'none';
            document.getElementById('addUserSuccess').style.display = 'none';
            document.getElementById('addUserName').focus();
        }

        function closeAddUserModal() {
            document.getElementById('addUserModal').style.display = 'none';
            document.getElementById('addUserForm').reset();
            document.getElementById('addUserError').style.display = 'none';
            document.getElementById('addUserSuccess').style.display = 'none';
        }

        async function submitAddUser(event) {
            event.preventDefault();
            
            const name = document.getElementById('addUserName').value.trim();
            const email = document.getElementById('addUserEmail').value.trim();
            const password = document.getElementById('addUserPassword').value;
            
            const errorDiv = document.getElementById('addUserError');
            const successDiv = document.getElementById('addUserSuccess');
            const submitBtn = document.getElementById('addUserSubmitBtn');
            
            errorDiv.style.display = 'none';
            successDiv.style.display = 'none';
            
            // Validation
            if (!name || !email || !password) {
                errorDiv.textContent = 'Please fill in all required fields.';
                errorDiv.style.display = 'block';
                return;
            }
            
            if (password.length < 6) {
                errorDiv.textContent = 'Password must be at least 6 characters.';
                errorDiv.style.display = 'block';
                return;
            }
            
            // Disable button during submission
            submitBtn.disabled = true;
            submitBtn.textContent = 'Creating...';
            
            try {
                const result = await api('/users/create', 'POST', {
                    name,
                    email,
                    password
                });
                
                if (result.success) {
                    successDiv.textContent = `‚úÖ User "${name}" created successfully!`;
                    successDiv.style.display = 'block';
                    
                    // Reload users list after 1.5 seconds
                    setTimeout(() => {
                        closeAddUserModal();
                        loadUsers();
                    }, 1500);
                } else {
                    errorDiv.textContent = result.message || 'Failed to create user.';
                    errorDiv.style.display = 'block';
                }
            } catch (error) {
                errorDiv.textContent = 'Network error. Please try again.';
                errorDiv.style.display = 'block';
            } finally {
                submitBtn.disabled = false;
                submitBtn.textContent = 'Create User';
            }
        }

        // Patch renderUsers to use new modal
        function renderUsers(users) {
            document.getElementById('usersTable').innerHTML = users.map(u => {
                const isOnline = onlineUserIds.includes(u.user_id);
                const statusBadge = isOnline 
                    ? '<span class="status-badge status-online">üü¢ Online</span>'
                    : '<span class="status-badge status-offline">‚ö™ Offline</span>';
                // Trash icon button
                const deleteBtn = `<button title="Delete User" class="delete-user-btn" onclick="showDeleteUserModal(${u.user_id}, '${u.name.replace(/'/g, '\'')}', this)"><svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 18L18 6M6 6l12 12'/></svg></button>`;
                return `
                <tr>
                    <td>${u.user_id}</td>
                    <td>${u.name}</td>
                    <td>${u.email}</td>
                    <td>${u.total_conversations}</td>
                    <td>${u.total_practice_minutes} min</td>
                    <td>${new Date(u.created_at).toLocaleDateString()}</td>
                    <td>${statusBadge}</td>
                    <td>${deleteBtn}</td>
                </tr>
            `}).join('') || '<tr><td colspan="8">No users found</td></tr>';
        }

        window.addEventListener('DOMContentLoaded', () => {
            deleteUserModal = document.getElementById('deleteUserModal');
            deleteTopicModal = document.getElementById('deleteTopicModal');
            deleteConversationModal = document.getElementById('deleteConversationModal');
        });

        async function refreshUsers() {
            await loadOnlineUserIds();
            await loadUsers();
        }

        function filterUsers() {
            const search = document.getElementById('userSearch').value.toLowerCase();
            
            const filtered = allUsers.filter(u => {
                const matchSearch = u.name.toLowerCase().includes(search) || u.email.toLowerCase().includes(search);
                return matchSearch;
            });
            
            renderUsers(filtered);
        }

        // ==================== USER LEVELS ====================
        let allUserLevels = [];

        async function loadUserLevels() {
            try {
                const result = await api('/user-levels');
                if (result.success && result.data) {
                    allUserLevels = result.data;
                    renderUserLevels(allUserLevels);
                } else {
                    document.getElementById('userLevelsContainer').innerHTML = '<div style="text-align:center;padding:40px;color:#7f8c8d;">No user levels found</div>';
                }
            } catch (error) {
                console.error('Error loading user levels:', error);
                document.getElementById('userLevelsContainer').innerHTML = '<div style="text-align:center;padding:40px;color:#e74c3c;">Failed to load user levels</div>';
            }
        }

        function renderUserLevels(userLevels) {
            const container = document.getElementById('userLevelsContainer');
            
            if (!userLevels || userLevels.length === 0) {
                container.innerHTML = '<div style="text-align:center;padding:40px;color:#7f8c8d;">No user levels found</div>';
                return;
            }

            const getLevelBadge = (level) => {
                const icons = { beginner: 'üå±', intermediate: '‚≠ê', advanced: 'üèÜ' };
                const colors = { beginner: '#27ae60', intermediate: '#f39c12', advanced: '#9b59b6' };
                return `<span style="background: ${colors[level]}20; color: ${colors[level]}; padding: 4px 10px; border-radius: 12px; font-size: 0.85rem; font-weight: 600;">${icons[level]} ${level.charAt(0).toUpperCase() + level.slice(1)}</span>`;
            };

            const getLangFlag = (code) => {
                const flags = { 
                    en: 'üá¨üáß', es: 'üá™üá∏', fr: 'üá´üá∑', de: 'üá©üá™', 
                    it: 'üáÆüáπ', pt: 'üáµüáπ', ru: 'üá∑üá∫', zh: 'üá®üá≥', 
                    ja: 'üáØüáµ', ko: 'üá∞üá∑', tr: 'üáπüá∑', ar: 'üá∏üá¶' 
                };
                return flags[code] || 'üåê';
            };

            container.innerHTML = userLevels.map(user => `
                <div style="background: #f8f9fa; border-radius: 12px; padding: 20px; margin-bottom: 20px; border: 1px solid #e9ecef;">
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px; border-bottom: 1px solid #dee2e6; padding-bottom: 15px;">
                        <div>
                            <h3 style="margin: 0; color: #2c3e50; font-size: 1.2rem;">üë§ ${user.user_name}</h3>
                            <span style="color: #7f8c8d; font-size: 0.9rem;">${user.user_email}</span>
                        </div>
                        <span style="background: #667eea20; color: #667eea; padding: 4px 12px; border-radius: 12px; font-size: 0.85rem;">${user.languages.length} Language${user.languages.length > 1 ? 's' : ''}</span>
                    </div>
                    <table style="width: 100%; font-size: 0.9rem;">
                        <thead>
                            <tr style="background: #e9ecef;">
                                <th style="padding: 10px; text-align: left; border-radius: 6px 0 0 6px;">Language</th>
                                <th style="padding: 10px; text-align: center;">Level</th>
                                <th style="padding: 10px; text-align: center;">Sessions</th>
                                <th style="padding: 10px; text-align: center;">Practice Time</th>
                                <th style="padding: 10px; text-align: center; border-radius: 0 6px 6px 0;">Avg Score</th>
                            </tr>
                        </thead>
                        <tbody>
                            ${user.languages.map(lang => `
                                <tr style="border-bottom: 1px solid #f1f2f6;">
                                    <td style="padding: 12px;">${getLangFlag(lang.language_code)} ${lang.language_name}</td>
                                    <td style="padding: 12px; text-align: center;">${getLevelBadge(lang.proficiency_level)}</td>
                                    <td style="padding: 12px; text-align: center;">${lang.total_sessions}</td>
                                    <td style="padding: 12px; text-align: center;">${lang.total_practice_time} min</td>
                                    <td style="padding: 12px; text-align: center;"><span style="background: ${lang.average_score >= 80 ? '#27ae6020' : lang.average_score >= 60 ? '#f39c1220' : '#e74c3c20'}; color: ${lang.average_score >= 80 ? '#27ae60' : lang.average_score >= 60 ? '#f39c12' : '#e74c3c'}; padding: 4px 10px; border-radius: 8px; font-weight: 600;">${lang.average_score}%</span></td>
                                </tr>
                            `).join('')}
                        </tbody>
                    </table>
                </div>
            `).join('');
        }

        function filterUserLevels() {
            const search = document.getElementById('userLevelsSearch').value.toLowerCase();
            const langFilter = document.getElementById('languageFilter').value;

            const filtered = allUserLevels.filter(user => {
                const matchSearch = user.user_name.toLowerCase().includes(search);
                const matchLang = !langFilter || user.languages.some(l => l.language_code === langFilter);
                return matchSearch && matchLang;
            }).map(user => {
                if (langFilter) {
                    return {
                        ...user,
                        languages: user.languages.filter(l => l.language_code === langFilter)
                    };
                }
                return user;
            });

            renderUserLevels(filtered);
        }

        async function viewUser(userId) {
            try {
                const result = await api(`/users/${userId}`);
                if (result.success) {
                    const { user, conversations, frequentMistakes, proficiency_by_language } = result.data;
                    
                    // Her dil i√ßin seviye bilgisini formatla
                    let languageLevelsHtml = '';
                    if (proficiency_by_language && Object.keys(proficiency_by_language).length > 0) {
                        languageLevelsHtml = '<h4>Proficiency by Language</h4><div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 15px; margin-bottom: 20px;">';
                        for (const [language, stats] of Object.entries(proficiency_by_language)) {
                            const levelText = stats.proficiency_level.charAt(0).toUpperCase() + stats.proficiency_level.slice(1);
                            const avgScore = stats.avg_score ? Math.round(stats.avg_score * 100) / 100 : 0;
                            const practiceMinutes = Math.round(stats.total_practice_seconds / 60);
                            languageLevelsHtml += `
                                <div style="border: 1px solid #ddd; padding: 15px; border-radius: 8px; background: #f9f9f9;">
                                    <h5 style="margin: 0 0 10px 0; color: #333;">${language}</h5>
                                    <p style="margin: 5px 0;"><strong>Level:</strong> <span class="badge badge-${stats.proficiency_level}">${levelText}</span></p>
                                    <p style="margin: 5px 0;"><strong>Avg Score:</strong> ${avgScore}%</p>
                                    <p style="margin: 5px 0;"><strong>Conversations:</strong> ${stats.total_conversations}</p>
                                    <p style="margin: 5px 0;"><strong>Practice Time:</strong> ${practiceMinutes} min</p>
                                </div>
                            `;
                        }
                        languageLevelsHtml += '</div>';
                    } else {
                        languageLevelsHtml = '<p style="color: #999; margin-bottom: 20px;">No language-specific statistics available yet.</p>';
                    }
                    
                    document.getElementById('userDetails').innerHTML = `
                        <div style="margin-bottom: 20px;">
                            <h3>${user.name}</h3>
                            <p><strong>Email:</strong> ${user.email}</p>
                            <p><strong>Registered:</strong> ${new Date(user.created_at).toLocaleDateString()}</p>
                        </div>
                        ${languageLevelsHtml}
                        <h4>Recent Conversations</h4>
                        <table style="width: 100%; margin-bottom: 20px;">
                            <thead>
                                <tr><th>Topic</th><th>Language</th><th>Score</th><th>Date</th></tr>
                            </thead>
                            <tbody>
                                ${conversations.map(c => `
                                    <tr>
                                        <td>${c.topic_name || 'N/A'}</td>
                                        <td>${c.target_language || 'English'}</td>
                                        <td>${c.overall_score ? Math.round(c.overall_score * 100) / 100 + '%' : '-'}</td>
                                        <td>${new Date(c.started_at).toLocaleDateString()}</td>
                                    </tr>
                                `).join('')}
                            </tbody>
                        </table>
                        <h4>Frequent Mistakes</h4>
                        <ul>
                            ${frequentMistakes && frequentMistakes.length > 0 
                                ? frequentMistakes.map(m => `<li>${m.mistake_type}: ${m.count} times</li>`).join('') 
                                : '<li>No mistakes recorded</li>'}
                        </ul>
                    `;
                    document.getElementById('userModal').classList.add('active');
                }
            } catch (error) {
                console.error('Error loading user:', error);
            }
        }

        // Conversations
        async function loadConversations() {
            try {
                const result = await api('/conversations');
                if (result.success && result.data && result.data.conversations) {
                    allConversations = result.data.conversations;
                    renderConversations(allConversations);
                } else {
                    document.getElementById('conversationsTable').innerHTML = '<tr><td colspan="9" style="text-align:center;padding:40px;color:#7f8c8d;">No conversations found</td></tr>';
                }
            } catch (error) {
                console.error('Error loading conversations:', error);
                document.getElementById('conversationsTable').innerHTML = '<tr><td colspan="9" style="text-align:center;padding:40px;color:#7f8c8d;">Failed to load conversations</td></tr>';
            }
        }

        function renderConversations(conversations) {
            document.getElementById('conversationsTable').innerHTML = conversations.map(c => {
                const deleteBtn = `<button title="Delete Conversation" class="delete-user-btn" onclick="showDeleteConversationModal(${c.conversation_id}, '${c.user_name.replace(/'/g, "\\'")}', '${(c.topic_name || 'N/A').replace(/'/g, "\\'")}', this)"><svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 18L18 6M6 6l12 12'/></svg></button>`;
                const targetLanguage = c.target_language || 'English';
                const languageFlags = {
                    'English': 'üá¨üáß',
                    'Spanish': 'üá™üá∏',
                    'French': 'üá´üá∑',
                    'German': 'üá©üá™',
                    'Italian': 'üáÆüáπ',
                    'Portuguese': 'üáµüáπ',
                    'Russian': 'üá∑üá∫',
                    'Chinese': 'üá®üá≥',
                    'Japanese': 'üáØüáµ',
                    'Korean': 'üá∞üá∑',
                    'Turkish': 'üáπüá∑',
                    'Arabic': 'üá∏üá¶'
                };
                const flag = languageFlags[targetLanguage] || 'üåê';
                return `
                    <tr>
                        <td>${c.conversation_id}</td>
                        <td>${c.user_name}</td>
                        <td>${c.topic_name || 'N/A'}</td>
                        <td><span style="font-size: 1.2em;">${flag}</span> ${targetLanguage}</td>
                        <td>${c.message_count}</td>
                        <td>${Math.floor(c.duration_seconds / 60)}m ${c.duration_seconds % 60}s</td>
                        <td>${c.overall_score || '-'}</td>
                        <td>${new Date(c.started_at).toLocaleString()}</td>
                        <td>${deleteBtn}</td>
                    </tr>
                `;
            }).join('') || '<tr><td colspan="9" style="text-align:center;padding:40px;color:#7f8c8d;">No conversations found</td></tr>';
        }

        function filterConversations() {
            const status = document.getElementById('convStatusFilter').value;
            const startDate = document.getElementById('convStartDate').value;
            const endDate = document.getElementById('convEndDate').value;
            
            const filtered = allConversations.filter(c => {
                const matchStatus = !status || c.status === status;
                const matchStart = !startDate || new Date(c.started_at) >= new Date(startDate);
                const matchEnd = !endDate || new Date(c.started_at) <= new Date(endDate + 'T23:59:59');
                return matchStatus && matchStart && matchEnd;
            });
            
            renderConversations(filtered);
        }

        async function viewConversation(conversationId) {
            try {
                const result = await api(`/conversations/${conversationId}`);
                if (result.success) {
                    const { messages } = result.data;
                    document.getElementById('messagesList').innerHTML = messages.map(m => `
                        <div class="message-item ${m.sender_type}">
                            <div class="message-sender">${m.sender_type === 'user' ? 'üë§ User' : 'ü§ñ AI'}</div>
                            <div>${m.content}</div>
                            <div class="message-time">${new Date(m.created_at).toLocaleString()}</div>
                        </div>
                    `).join('') || '<p>No messages</p>';
                    document.getElementById('messagesModal').classList.add('active');
                }
            } catch (error) {
                console.error('Error loading messages:', error);
            }
        }

        // Topics
        let allTopics = [];
        
        async function loadTopics() {
            try {
                const result = await api('/topics');
                if (result.success) {
                    allTopics = result.data.topics || [];
                    renderTopics(allTopics);
                }
            } catch (error) {
                console.error('Error loading topics:', error);
                document.getElementById('topicsTable').innerHTML = '<tr><td colspan="6" style="text-align:center;padding:40px;color:#7f8c8d;">Failed to load topics</td></tr>';
            }
        }
        
        function renderTopics(topics) {
            document.getElementById('topicsTable').innerHTML = topics.map(t => {
                const deleteBtn = `<button title="Delete Topic" class="delete-user-btn" onclick="showDeleteTopicModal(${t.topic_id}, '${t.name.replace(/'/g, "\\'")}', this)"><svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 18L18 6M6 6l12 12'/></svg></button>`;
                const languageBadge = `<span class="badge badge-info" style="font-size: 0.75rem;">üåê ${t.target_language || 'English'}</span>`;
                return `
                    <tr>
                        <td>${t.topic_id}</td>
                        <td>${t.name}</td>
                        <td>${t.category}</td>
                        <td><span class="badge badge-${t.difficulty}">${t.difficulty}</span></td>
                        <td>${languageBadge}</td>
                        <td>${t.usage_count}</td>
                        <td>${deleteBtn}</td>
                    </tr>
                `;
            }).join('') || '<tr><td colspan="7" style="text-align:center;padding:40px;color:#7f8c8d;">No topics found</td></tr>';
        }

        // Analytics
        async function loadAnalytics() {
            try {
                const result = await api('/analytics/daily?days=30');
                if (result.success && result.data && result.data.length > 0) {
                    document.getElementById('analyticsTable').innerHTML = result.data.map(d => `
                        <tr>
                            <td>${d.date}</td>
                            <td>${d.active_users}</td>
                            <td>${d.total_conversations}</td>
                            <td>${d.total_messages}</td>
                            <td>${(d.avg_score || 0).toFixed(1)}</td>
                        </tr>
                    `).join('');
                } else {
                    document.getElementById('analyticsTable').innerHTML = '<tr><td colspan="5" style="text-align:center;padding:40px;color:#7f8c8d;">No analytics data available</td></tr>';
                }
            } catch (error) {
                console.error('Error loading analytics:', error);
                document.getElementById('analyticsTable').innerHTML = '<tr><td colspan="5" style="text-align:center;padding:40px;color:#7f8c8d;">No analytics data available</td></tr>';
            }
        }

        // Refresh functions
        function refreshConversations() { loadConversations(); }

        // Modal
        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }
        
        // ==================== TOPIC MANAGEMENT ====================
        
        function showAddTopicModal() {
            // Reset form
            document.getElementById('addTopicForm').reset();
            document.getElementById('addTopicModal').classList.add('active');
        }
        
        async function submitAddTopic(event) {
            event.preventDefault();
            
            const btn = document.getElementById('addTopicBtn');
            const originalText = btn.innerHTML;
            btn.innerHTML = '‚è≥ Adding...';
            btn.disabled = true;
            
            const name = document.getElementById('topicName').value.trim();
            const description = document.getElementById('topicDescription').value.trim();
            const category = document.getElementById('topicCategory').value;
            const difficulty = document.getElementById('topicDifficulty').value;
            const targetLanguage = document.getElementById('topicTargetLanguage').value;
            const questionsText = document.getElementById('topicQuestions').value.trim();
            
            // Parse sample questions (one per line)
            const sampleQuestions = questionsText ? questionsText.split('\n').filter(q => q.trim()).map(q => q.trim()) : [];
            
            try {
                const result = await api('/topics', 'POST', {
                    name,
                    description,
                    category,
                    difficulty,
                    targetLanguage,
                    sampleQuestions
                });
                
                if (result.success) {
                    alert('‚úÖ Topic added successfully!');
                    closeModal('addTopicModal');
                    await loadTopics(); // Refresh topics list
                } else {
                    alert('‚ùå Error: ' + (result.message || 'Failed to add topic'));
                }
            } catch (error) {
                console.error('Error adding topic:', error);
                alert('‚ùå Error adding topic. Please try again.');
            } finally {
                btn.innerHTML = originalText;
                btn.disabled = false;
            }
        }
        
        async function editTopic(topicId) {
            alert('Edit topic feature coming soon! Topic ID: ' + topicId);
        }

        // ==================== DELETE TOPIC ====================
        
        let deleteTopicModal = null;
        let deleteTopicModalBtn = null;
        let deleteTopicModalTopicId = null;
        
        function showDeleteTopicModal(topicId, topicName, btn) {
            deleteTopicModalTopicId = topicId;
            deleteTopicModalBtn = btn;
            document.getElementById('deleteTopicModalName').textContent = topicName;
            deleteTopicModal.classList.add('active');
        }
        
        async function confirmDeleteTopic() {
            const topicId = deleteTopicModalTopicId;
            const btn = deleteTopicModalBtn;
            btn.disabled = true;
            btn.innerHTML = '<span style="color:#e74c3c;">Deleting...</span>';
            
            try {
                const result = await api(`/topics/${topicId}`, 'DELETE');
                
                if (result.success) {
                    // Remove from local array
                    allTopics = allTopics.filter(t => t.topic_id !== topicId);
                    renderTopics(allTopics);
                    closeDeleteTopicModal();
                } else {
                    showDeleteTopicError(result.message || 'Failed to delete topic.');
                    btn.disabled = false;
                    btn.innerHTML = `<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 18L18 6M6 6l12 12'/></svg>`;
                }
            } catch (error) {
                console.error('Error deleting topic:', error);
                showDeleteTopicError('Failed to delete topic.');
                btn.disabled = false;
                btn.innerHTML = `<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 18L18 6M6 6l12 12'/></svg>`;
            }
        }
        
        function closeDeleteTopicModal() {
            if (deleteTopicModal) {
                deleteTopicModal.classList.remove('active');
                document.getElementById('deleteTopicModalError').style.display = 'none';
            }
        }
        
        function showDeleteTopicError(msg) {
            const err = document.getElementById('deleteTopicModalError');
            err.textContent = msg;
            err.style.display = 'block';
        }

        // ==================== DELETE CONVERSATION ====================
        
        let deleteConversationModal = null;
        let deleteConversationModalBtn = null;
        let deleteConversationModalConvId = null;
        
        function showDeleteConversationModal(conversationId, userName, topicName, btn) {
            deleteConversationModalConvId = conversationId;
            deleteConversationModalBtn = btn;
            document.getElementById('deleteConversationModalId').textContent = conversationId;
            document.getElementById('deleteConversationModalUser').textContent = userName;
            document.getElementById('deleteConversationModalTopic').textContent = topicName || 'N/A';
            deleteConversationModal.classList.add('active');
        }
        
        async function confirmDeleteConversation() {
            const conversationId = deleteConversationModalConvId;
            const btn = deleteConversationModalBtn;
            btn.disabled = true;
            btn.innerHTML = '<span style="color:#e74c3c;">Deleting...</span>';
            
            try {
                const result = await api(`/conversations/${conversationId}`, 'DELETE');
                
                if (result.success) {
                    // Remove from local array
                    allConversations = allConversations.filter(c => c.conversation_id !== conversationId);
                    renderConversations(allConversations);
                    closeDeleteConversationModal();
                } else {
                    showDeleteConversationError(result.message || 'Failed to delete conversation.');
                    btn.disabled = false;
                    btn.innerHTML = `<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 18L18 6M6 6l12 12'/></svg>`;
                }
            } catch (error) {
                console.error('Error deleting conversation:', error);
                showDeleteConversationError('Failed to delete conversation.');
                btn.disabled = false;
                btn.innerHTML = `<svg xmlns='http://www.w3.org/2000/svg' width='18' height='18' fill='none' viewBox='0 0 24 24' stroke='currentColor'><path stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M6 18L18 6M6 6l12 12'/></svg>`;
            }
        }
        
        function closeDeleteConversationModal() {
            if (deleteConversationModal) {
                deleteConversationModal.classList.remove('active');
                document.getElementById('deleteConversationModalError').style.display = 'none';
            }
        }
        
        function showDeleteConversationError(msg) {
            const err = document.getElementById('deleteConversationModalError');
            err.textContent = msg;
            err.style.display = 'block';
        }
        
        // ==================== ACTIVE SESSIONS ====================
        
        let activeSessionsInterval = null;
        
        async function showActiveSessions() {
            const modal = document.getElementById('activeSessionsModal');
            modal.classList.add('active');
            await loadActiveSessions();
            
            // Auto-refresh every 3 seconds
            activeSessionsInterval = setInterval(loadActiveSessions, 3000);
        }
        
        function closeActiveSessionsModal() {
            document.getElementById('activeSessionsModal').classList.remove('active');
            if (activeSessionsInterval) {
                clearInterval(activeSessionsInterval);
                activeSessionsInterval = null;
            }
        }
        
        async function loadActiveSessions() {
            try {
                const response = await fetch('/api/admin/active-sessions');
                const result = await response.json();
                
                if (result.success) {
                    const container = document.getElementById('activeSessionsList');
                    document.getElementById('activeSessionsCount').textContent = result.count;
                    document.getElementById('stat-active').textContent = result.count;
                    
                    if (result.sessions.length === 0) {
                        container.innerHTML = `
                            <div style="text-align: center; padding: 40px; color: #999;">
                                <div style="font-size: 3rem; margin-bottom: 15px;">üò¥</div>
                                <h3>No Active Sessions</h3>
                                <p>No users are currently practicing.</p>
                            </div>
                        `;
                    } else {
                        container.innerHTML = result.sessions.map(s => `
                            <div style="background: #f8f9fa; padding: 15px; border-radius: 10px; margin-bottom: 10px; border-left: 4px solid #28a745;">
                                <div style="display: flex; justify-content: space-between; align-items: center;">
                                    <div>
                                        <div style="font-weight: bold; font-size: 1.1rem;">üë§ ${s.userName}</div>
                                        <div style="color: #666; font-size: 0.9rem;">${s.userEmail}</div>
                                    </div>
                                    <div style="text-align: right;">
                                        <div style="background: #28a745; color: white; padding: 3px 10px; border-radius: 15px; font-size: 0.8rem;">
                                            üü¢ LIVE
                                        </div>
                                    </div>
                                </div>
                                <div style="margin-top: 10px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px;">
                                    <div style="text-align: center; background: white; padding: 8px; border-radius: 8px;">
                                        <div style="font-size: 0.8rem; color: #666;">Topic</div>
                                        <div style="font-weight: bold; color: #667eea;">${s.topicName}</div>
                                    </div>
                                    <div style="text-align: center; background: white; padding: 8px; border-radius: 8px;">
                                        <div style="font-size: 0.8rem; color: #666;">Duration</div>
                                        <div style="font-weight: bold; color: #2ecc71;">${formatDuration(s.duration)}</div>
                                    </div>
                                    <div style="text-align: center; background: white; padding: 8px; border-radius: 8px;">
                                        <div style="font-size: 0.8rem; color: #666;">Started</div>
                                        <div style="font-weight: bold;">${new Date(s.startTime).toLocaleTimeString()}</div>
                                    </div>
                                </div>
                            </div>
                        `).join('');
                    }
                    
                    document.getElementById('activeSessionsLastUpdate').textContent = 
                        'Last updated: ' + new Date().toLocaleTimeString();
                }
            } catch (error) {
                console.error('Error loading active sessions:', error);
            }
        }
        
        function formatDuration(seconds) {
            if (seconds < 60) return seconds + 's';
            const mins = Math.floor(seconds / 60);
            const secs = seconds % 60;
            return mins + 'm ' + secs + 's';
        }
        
        // Also update active sessions count periodically on dashboard
        setInterval(async () => {
            try {
                const response = await fetch('/api/admin/active-sessions');
                const result = await response.json();
                if (result.success) {
                    document.getElementById('stat-active').textContent = result.count;
                }
            } catch (e) {}
        }, 5000);

        // Initialize
        loadDashboard();
    </script>
    
    <!-- Active Sessions Modal -->
    <div id="activeSessionsModal" class="modal" style="display: none; position: fixed; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); z-index: 1000; justify-content: center; align-items: center;">
        <div style="background: white; border-radius: 15px; width: 90%; max-width: 700px; max-height: 80vh; overflow: hidden; box-shadow: 0 10px 40px rgba(0,0,0,0.2);">
            <div style="padding: 20px; background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; display: flex; justify-content: space-between; align-items: center;">
                <div>
                    <h2 style="margin: 0;">üü¢ Active Practice Sessions</h2>
                    <p style="margin: 5px 0 0 0; opacity: 0.9; font-size: 0.9rem;">
                        <span id="activeSessionsCount">0</span> users currently practicing
                    </p>
                </div>
                <button onclick="closeActiveSessionsModal()" style="background: rgba(255,255,255,0.2); border: none; color: white; width: 35px; height: 35px; border-radius: 50%; cursor: pointer; font-size: 1.2rem;">‚úï</button>
            </div>
            <div style="padding: 20px; max-height: 50vh; overflow-y: auto;" id="activeSessionsList">
                <div style="text-align: center; padding: 20px;">Loading...</div>
            </div>
            <div style="padding: 15px; background: #f8f9fa; border-top: 1px solid #eee; display: flex; justify-content: space-between; align-items: center;">
                <span id="activeSessionsLastUpdate" style="color: #666; font-size: 0.85rem;">Loading...</span>
                <button onclick="loadActiveSessions()" style="background: #667eea; color: white; border: none; padding: 8px 20px; border-radius: 5px; cursor: pointer;">üîÑ Refresh</button>
            </div>
        </div>
    </div>
    
    <style>
        .modal.active { display: flex !important; }
        .stat-card.clickable:hover { transform: scale(1.02); box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        
        /* Delete button styles */
        .delete-user-btn {
            background: none;
            border: none;
            cursor: pointer;
            color: #e74c3c;
            padding: 5px;
            border-radius: 4px;
            transition: all 0.2s;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }
        
        .delete-user-btn:hover {
            background: rgba(231, 76, 60, 0.1);
            color: #c0392b;
            transform: scale(1.1);
        }
        
        .delete-user-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }
    </style>
    </div> <!-- End main-content -->
    </div> <!-- End adminPanel -->
</body>
</html>